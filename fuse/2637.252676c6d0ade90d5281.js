(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[2637],{52637:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ScrumboardModule:()=>wt});var r=i(63423),s=i(83461),o=i(51095),n=i(7539),a=i(22238),c=i(72458),l=i(43220),d=i(98295),u=i(76627),p=i(83166),m=i(33935),b=i(36063),h=i(12178),g=i(16738),f=i(44466),x=i(79765),v=i(46782),_=i(37716),Z=i(26215),k=i(40205),w=i(25917),y=i(88002),A=i(93342),T=i(15257),q=i(43190);class I{constructor(t){this.id=t.id||null,this.title=t.title,this.description=t.description||null,this.icon=t.icon||null,this.lastActivity=t.lastActivity||null,this.lists=[],this.labels=[],this.members=[],t.lists&&(this.lists=t.lists.map(t=>t instanceof C?t:new C(t))),t.labels&&(this.labels=t.labels.map(t=>t instanceof L?t:new L(t))),t.members&&(this.members=t.members.map(t=>t instanceof J?t:new J(t)))}}class C{constructor(t){this.id=t.id||null,this.boardId=t.boardId,this.position=t.position,this.title=t.title,this.cards=[],t.cards&&(this.cards=t.cards.map(t=>t instanceof D?t:new D(t)))}}class D{constructor(t){this.id=t.id||null,this.boardId=t.boardId,this.listId=t.listId,this.position=t.position,this.title=t.title,this.description=t.description||null,this.labels=[],this.dueDate=t.dueDate||null,t.labels&&(this.labels=t.labels.map(t=>t instanceof L?t:new L(t)))}}class J{constructor(t){this.id=t.id||null,this.name=t.name,this.avatar=t.avatar||null}}class L{constructor(t){this.id=t.id||null,this.boardId=t.boardId,this.title=t.title}}var Q=i(91841);let U=(()=>{class t{constructor(t){this._httpClient=t,this._board=new Z.X(null),this._boards=new Z.X(null),this._card=new Z.X(null)}get board$(){return this._board.asObservable()}get boards$(){return this._boards.asObservable()}get card$(){return this._card.asObservable()}getBoards(){return this._httpClient.get("api/apps/scrumboard/boards").pipe((0,y.U)(t=>t.map(t=>new I(t))),(0,A.b)(t=>this._boards.next(t)))}getBoard(t){return this._httpClient.get("api/apps/scrumboard/board",{params:{id:t}}).pipe((0,y.U)(t=>new I(t)),(0,A.b)(t=>this._board.next(t)))}createBoard(t){return this.boards$.pipe((0,T.q)(1),(0,q.w)(e=>this._httpClient.put("api/apps/scrumboard/board",{board:t}).pipe((0,y.U)(t=>(this._boards.next([...e,t]),t)))))}updateBoard(t,e){return this.boards$.pipe((0,T.q)(1),(0,q.w)(i=>this._httpClient.patch("api/apps/scrumboard/board",{id:t,board:e}).pipe((0,y.U)(e=>{const r=i.findIndex(e=>e.id===t);return i[r]=e,this._boards.next(i),e}))))}deleteBoard(t){return this.boards$.pipe((0,T.q)(1),(0,q.w)(e=>this._httpClient.delete("api/apps/scrumboard/board",{params:{id:t}}).pipe((0,y.U)(i=>{const r=e.findIndex(e=>e.id===t);return e.splice(r,1),this._boards.next(e),this._board.next(null),this._card.next(null),i}))))}createList(t){return this._httpClient.post("api/apps/scrumboard/board/list",{list:t}).pipe((0,y.U)(t=>new C(t)),(0,A.b)(t=>{const e=this._board.value;e.lists=[...e.lists,t],e.lists.sort((t,e)=>t.position-e.position),this._board.next(e)}))}updateList(t){return this._httpClient.patch("api/apps/scrumboard/board/list",{list:t}).pipe((0,y.U)(t=>new C(t)),(0,A.b)(e=>{const i=this._board.value,r=i.lists.findIndex(e=>e.id===t.id);i.lists[r]=e,i.lists.sort((t,e)=>t.position-e.position),this._board.next(i)}))}updateLists(t){return this._httpClient.patch("api/apps/scrumboard/board/lists",{lists:t}).pipe((0,y.U)(t=>t.map(t=>new C(t))),(0,A.b)(t=>{const e=this._board.value;t.forEach(t=>{const i=e.lists.findIndex(e=>e.id===t.id);e.lists[i]=t}),e.lists.sort((t,e)=>t.position-e.position),this._board.next(e)}))}deleteList(t){return this._httpClient.delete("api/apps/scrumboard/board/list",{params:{id:t}}).pipe((0,A.b)(e=>{const i=this._board.value,r=i.lists.findIndex(e=>e.id===t);i.lists.splice(r,1),i.lists.sort((t,e)=>t.position-e.position),this._board.next(i)}))}getCard(t){return this._board.pipe((0,T.q)(1),(0,y.U)(e=>{const i=e.lists.find(e=>e.cards.some(e=>e.id===t)).cards.find(e=>e.id===t);return this._card.next(i),i}),(0,q.w)(e=>e?(0,w.of)(e):(0,k._)("Could not found the card with id of "+t+"!")))}createCard(t){return this._httpClient.put("api/apps/scrumboard/board/card",{card:t}).pipe((0,y.U)(t=>new D(t)),(0,A.b)(t=>{const e=this._board.value;return e.lists.forEach((e,i,r)=>{e.id===t.listId&&r[i].cards.push(t)}),this._board.next(e),t}))}updateCard(t,e){return this.board$.pipe((0,T.q)(1),(0,q.w)(i=>this._httpClient.patch("api/apps/scrumboard/board/card",{id:t,card:e}).pipe((0,y.U)(e=>(i.lists.forEach(i=>{i.cards.forEach((i,r,s)=>{i.id===t&&(s[r]=e)})}),this._board.next(i),this._card.next(e),e)))))}updateCards(t){return this._httpClient.patch("api/apps/scrumboard/board/cards",{cards:t}).pipe((0,y.U)(t=>t.map(t=>new D(t))),(0,A.b)(t=>{const e=this._board.value;t.forEach(t=>{const i=e.lists.findIndex(e=>e.id===t.listId),r=e.lists[i].cards.findIndex(e=>e.id===t.id);e.lists[i].cards[r]=t,e.lists[i].cards.sort((t,e)=>t.position-e.position)}),this._board.next(e)}))}deleteCard(t){return this.board$.pipe((0,T.q)(1),(0,q.w)(e=>this._httpClient.delete("api/apps/scrumboard/board/card",{params:{id:t}}).pipe((0,y.U)(i=>(e.lists.forEach(e=>{e.cards.forEach((e,i,r)=>{e.id===t&&r.splice(i,1)})}),this._board.next(e),this._card.next(null),i)))))}updateCardPositions(t){}createLabel(t){return this.board$.pipe((0,T.q)(1),(0,q.w)(e=>this._httpClient.post("api/apps/scrumboard/board/label",{label:t}).pipe((0,y.U)(t=>(e.labels=[...e.labels,t],this._board.next(e),t)))))}updateLabel(t,e){return this.board$.pipe((0,T.q)(1),(0,q.w)(i=>this._httpClient.patch("api/apps/scrumboard/board/label",{id:t,label:e}).pipe((0,y.U)(e=>{const r=i.labels.findIndex(e=>e.id===t);return i.labels[r]=e,this._board.next(i),e}))))}deleteLabel(t){return this.board$.pipe((0,T.q)(1),(0,q.w)(e=>this._httpClient.delete("api/apps/scrumboard/board/label",{params:{id:t}}).pipe((0,y.U)(i=>{const r=e.labels.findIndex(e=>e.id===t);return e.labels.splice(r,1),i&&e.lists.forEach(e=>{e.cards.forEach(e=>{const i=e.labels.findIndex(e=>e.id===t);i>-1&&e.labels.splice(i,1)})}),this._board.next(e),i}))))}search(t){return this._httpClient.get("api/apps/scrumboard/board/search",{params:{query:t}})}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(Q.eN))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var F=i(74937),B=i(38583);function O(t,e){if(1&t&&(_.ynx(0),_._UZ(1,"img",18),_.BQk()),2&t){const t=e.$implicit;_.xp6(1),_.Q6J("src",t.avatar,_.LSH)}}function N(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"div",19),_.TgZ(2,"div",20),_._uU(3),_.qZA(),_.qZA(),_.BQk()),2&t){const t=_.oxw(2).$implicit;_.xp6(3),_.hij(" +",t.members.slice(5).length," ")}}function S(t,e){if(1&t&&(_.ynx(0),_._UZ(1,"div",16),_.TgZ(2,"div",17),_.YNc(3,O,2,1,"ng-container",4),_.YNc(4,N,4,1,"ng-container",12),_.qZA(),_.BQk()),2&t){const t=_.oxw().$implicit,e=_.oxw();_.xp6(3),_.Q6J("ngForOf",t.members.slice(0,5))("ngForTrackBy",e.trackByFn),_.xp6(1),_.Q6J("ngIf",t.members.length>5)}}const Y=function(t){return[t]};function R(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"a",7),_.TgZ(2,"div",8),_._UZ(3,"mat-icon",9),_.qZA(),_.TgZ(4,"div",10),_._uU(5),_.qZA(),_.TgZ(6,"div",11),_._uU(7),_.qZA(),_.YNc(8,S,5,3,"ng-container",12),_.TgZ(9,"div",13),_.TgZ(10,"div",14),_._uU(11,"Edited:"),_.qZA(),_.TgZ(12,"div",15),_._uU(13),_.qZA(),_.qZA(),_.qZA(),_.BQk()),2&t){const t=e.$implicit,i=_.oxw();_.xp6(1),_.Q6J("routerLink",_.VKq(6,Y,t.id)),_.xp6(2),_.Q6J("svgIcon",t.icon),_.xp6(2),_.Oqu(t.title),_.xp6(2),_.Oqu(t.description),_.xp6(1),_.Q6J("ngIf",null==t.members?null:t.members.length),_.xp6(5),_.Oqu(i.formatDateAsRelative(t.lastActivity))}}let M=(()=>{class t{constructor(t,e){this._changeDetectorRef=t,this._scrumboardService=e,this._unsubscribeAll=new x.xQ}ngOnInit(){this._scrumboardService.boards$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(t=>{this.boards=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}formatDateAsRelative(t){return g(t,g.ISO_8601).fromNow()}trackByFn(t,e){return e.id||t}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(_.sBO),_.Y36(U))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-boards"]],decls:8,vars:3,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-auto","items-center","p-6","sm:p-10"],[1,"mt-4","md:mt-24","text-3xl","md:text-6xl","font-extrabold","tracking-tight","leading-7","sm:leading-10"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","mt-8","md:mt-16"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-col","items-center","justify-center","w-56","rounded-lg","cursor-pointer","border-2","border-gray-300","border-dashed","hover:bg-hover","transition-colors","duration-150","ease-in-out"],[1,"icon-size-12","text-hint",3,"svgIcon"],[1,"flex","flex-col","items-start","w-56","p-6","rounded-lg","shadow","bg-card","rounded-lg","hover:shadow-xl","transition-shadow","duration-150","ease-in-out",3,"routerLink"],[1,"flex","items-center","justify-center","p-4","rounded-full","bg-primary-50","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"mt-0.5","line-clamp-2","text-secondary"],[4,"ngIf"],[1,"flex","items-center","mt-4","text-md","font-md"],[1,"text-secondary"],[1,"ml-1"],[1,"w-12","h-1","mt-6","border-t-2"],[1,"flex","items-center","mt-6","-space-x-1.5"],["alt","Member avatar",1,"flex-0","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","object-cover",3,"src"],[1,"flex","flex-0","items-center","justify-center","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","bg-gray-200","text-gray-500"],[1,"text-md","font-semibold"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_._uU(3," Scrumboard Boards "),_.qZA(),_.TgZ(4,"div",3),_.YNc(5,R,14,8,"ng-container",4),_.TgZ(6,"div",5),_._UZ(7,"mat-icon",6),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(5),_.Q6J("ngForOf",e.boards)("ngForTrackBy",e.trackByFn),_.xp6(2),_.Q6J("svgIcon","heroicons_outline:plus"))},directives:[F.PQ,B.sg,u.Hw,r.yS,B.O5],encapsulation:2,changeDetection:0}),t})();var V=i(5304);let $=(()=>{class t{constructor(t){this._scrumboardService=t}resolve(t,e){return this._scrumboardService.getBoards()}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(U))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),z=(()=>{class t{constructor(t,e){this._router=t,this._scrumboardService=e}resolve(t,e){return this._scrumboardService.getBoard(t.paramMap.get("boardId")).pipe((0,V.K)(t=>{console.error(t);const i=e.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(i),(0,k._)(t)}))}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(r.F0),_.LFG(U))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),j=(()=>{class t{constructor(t,e){this._router=t,this._scrumboardService=e}resolve(t,e){return this._scrumboardService.getCard(t.paramMap.get("cardId")).pipe((0,V.K)(t=>{console.error(t);const i=e.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(i),(0,k._)(t)}))}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(r.F0),_.LFG(U))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var E=i(3679);const G=["titleInput"],H=function(t){return{"opacity-0 pointer-events-none":t}},K=function(t){return{"opacity-0":t}};let P=(()=>{class t{constructor(t,e){this._changeDetectorRef=t,this._formBuilder=e,this.buttonTitle="Add a list",this.saved=new _.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const t=this.form.get("title").value;t&&""!==t.trim()&&(this.saved.next(t.trim()),this.form.get("title").setValue(""),this.formVisible=!1,this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(_.sBO),_.Y36(E.qu))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-board-add-list"]],viewQuery:function(t,e){if(1&t&&_.Gf(G,5),2&t){let t;_.iGM(t=_.CRH())&&(e.titleInput=t.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:14,vars:18,consts:[[1,"mt-11","w-64","py-2.5","px-2"],[1,"relative","flex","w-full","h-full","overflow-hidden","rounded-xl","bg-gray-200","dark:bg-gray-700"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","px-3","rounded-xl","bg-transparent",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full","p-3",3,"ngClass","formGroup"],[1,"w-full","py-2","px-3","leading-5","rounded-md","shadow-sm","border","border-gray-300","bg-white","focus:border-primary","dark:border-gray-500","dark:focus:border-primary","dark:bg-black","dark:bg-opacity-5",3,"autocomplete","formControlName","placeholder","keydown.enter"],["titleInput",""],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"button",2),_.NdJ("click",function(){return e.toggleFormVisibility()}),_._UZ(3,"mat-icon",3),_.TgZ(4,"span",4),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"form",5),_.TgZ(7,"input",6,7),_.NdJ("keydown.enter",function(){return e.save()}),_.qZA(),_.TgZ(9,"div",8),_.TgZ(10,"button",9),_.NdJ("click",function(){return e.save()}),_._uU(11," Add list "),_.qZA(),_.TgZ(12,"button",10),_.NdJ("click",function(){return e.toggleFormVisibility()}),_._UZ(13,"mat-icon",11),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.ekj("h-15",!e.formVisible),_.xp6(2),_.Q6J("ngClass",_.VKq(14,H,e.formVisible)),_.xp6(1),_.Q6J("svgIcon","heroicons_outline:plus-circle"),_.xp6(2),_.Oqu(e.buttonTitle),_.xp6(1),_.Q6J("ngClass",_.VKq(16,K,!e.formVisible))("formGroup",e.form),_.xp6(1),_.Q6J("autocomplete","off")("formControlName","title")("placeholder","Enter list title..."),_.xp6(3),_.Q6J("color","primary")("type","button"),_.xp6(2),_.Q6J("type","button"),_.xp6(1),_.Q6J("svgIcon","heroicons_solid:x"))},directives:[o.lW,B.mk,u.Hw,E._Y,E.JL,E.sg,E.Fj,E.JJ,E.u],encapsulation:2,changeDetection:0}),t})();var X=i(96109);const W=["titleInput"],tt=["titleAutosize"],et=function(t){return{"opacity-0 pointer-events-none":t}},it=function(t){return{"opacity-0":t}};let rt=(()=>{class t{constructor(t,e){this._changeDetectorRef=t,this._formBuilder=e,this.buttonTitle="Add a card",this.saved=new _.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const t=this.form.get("title").value;t&&""!==t.trim()&&(this.saved.next(t.trim()),this.formVisible=!1,this.form.get("title").setValue(""),setTimeout(()=>{this.titleInput.nativeElement.value="",this.titleAutosize.reset()}),this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(_.sBO),_.Y36(E.qu))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-board-add-card"]],viewQuery:function(t,e){if(1&t&&(_.Gf(W,5),_.Gf(tt,5)),2&t){let t;_.iGM(t=_.CRH())&&(e.titleInput=t.first),_.iGM(t=_.CRH())&&(e.titleAutosize=t.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},decls:17,vars:18,consts:[[1,"p-3","pt-0"],[1,"relative","flex","w-full","h-full","rounded-lg"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","px-5","rounded-lg",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full",3,"ngClass","formGroup"],[1,"flex","w-full","p-5","rounded-lg","shadow","bg-card"],["cdkTextareaAutosize","",1,"w-full","text-lg","font-medium","leading-5",3,"spellcheck","formControlName","placeholder","keydown.enter"],["titleInput","","titleAutosize","cdkTextareaAutosize"],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"button",2),_.NdJ("click",function(){return e.toggleFormVisibility()}),_._UZ(3,"mat-icon",3),_.TgZ(4,"span",4),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"form",5),_.TgZ(7,"div",6),_.TgZ(8,"textarea",7,8),_.NdJ("keydown.enter",function(){return e.save()}),_._uU(11,"                "),_.qZA(),_.qZA(),_.TgZ(12,"div",9),_.TgZ(13,"button",10),_.NdJ("click",function(){return e.save()}),_._uU(14," Add card "),_.qZA(),_.TgZ(15,"button",11),_.NdJ("click",function(){return e.toggleFormVisibility()}),_._UZ(16,"mat-icon",12),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.ekj("h-13",!e.formVisible),_.xp6(2),_.Q6J("ngClass",_.VKq(14,et,e.formVisible)),_.xp6(1),_.Q6J("svgIcon","heroicons_outline:plus-circle"),_.xp6(2),_.Oqu(e.buttonTitle),_.xp6(1),_.Q6J("ngClass",_.VKq(16,it,!e.formVisible))("formGroup",e.form),_.xp6(2),_.Q6J("spellcheck","off")("formControlName","title")("placeholder","Enter card title..."),_.xp6(5),_.Q6J("color","primary")("type","button"),_.xp6(2),_.Q6J("type","button"),_.xp6(1),_.Q6J("svgIcon","heroicons_solid:x"))},directives:[o.lW,B.mk,u.Hw,E._Y,E.JL,E.sg,X.IC,E.Fj,E.JJ,E.u],encapsulation:2,changeDetection:0}),t})();function st(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"div",30),_._UZ(2,"img",31),_.qZA(),_.BQk()),2&t){const t=_.oxw().$implicit;_.xp6(2),_.Q6J("src",t.coverImage,_.LSH)}}function ot(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"div",33),_._uU(2),_.qZA(),_.BQk()),2&t){const t=e.$implicit;_.xp6(2),_.hij(" ",t.title," ")}}function nt(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"div"),_.TgZ(2,"div",32),_.YNc(3,ot,3,1,"ng-container",11),_.qZA(),_.qZA(),_.BQk()),2&t){const t=_.oxw().$implicit,e=_.oxw(2);_.xp6(3),_.Q6J("ngForOf",t.labels)("ngForTrackBy",e.trackByFn)}}const at=function(t){return{"text-red-600":t}};function ct(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"div",34),_._UZ(2,"mat-icon",35),_.TgZ(3,"div",20),_._uU(4),_.ALo(5,"date"),_.qZA(),_.qZA(),_.BQk()),2&t){const t=_.oxw().$implicit,e=_.oxw(2);_.xp6(1),_.Q6J("ngClass",_.VKq(6,at,e.isOverdue(t.dueDate))),_.xp6(1),_.Q6J("svgIcon","heroicons_outline:clock"),_.xp6(2),_.hij(" ",_.xi3(5,3,t.dueDate,"longDate")," ")}}const lt=function(t){return["card",t]};function dt(t,e){if(1&t&&(_.ynx(0),_.TgZ(1,"a",27),_.YNc(2,st,3,1,"ng-container",28),_.TgZ(3,"div",29),_._uU(4),_.qZA(),_.YNc(5,nt,4,2,"ng-container",28),_.YNc(6,ct,6,8,"ng-container",28),_.qZA(),_.BQk()),2&t){const t=e.$implicit;_.xp6(1),_.Q6J("routerLink",_.VKq(5,lt,t.id)),_.xp6(1),_.Q6J("ngIf",t.coverImage),_.xp6(2),_.Oqu(t.title),_.xp6(1),_.Q6J("ngIf",t.labels.length),_.xp6(1),_.Q6J("ngIf",t.dueDate)}}function ut(t,e){if(1&t){const t=_.EpF();_.ynx(0),_.TgZ(1,"div",14),_.TgZ(2,"div",15),_.TgZ(3,"div",16),_.TgZ(4,"input",17,18),_.NdJ("focusout",function(e){const i=_.CHM(t).$implicit;return _.oxw().updateListTitle(e,i)})("keydown.enter",function(){return _.CHM(t),_.MAs(5).blur()}),_.qZA(),_.qZA(),_.TgZ(6,"div",19),_._uU(7),_.qZA(),_.TgZ(8,"div",20),_.TgZ(9,"button",21),_._UZ(10,"mat-icon",22),_.qZA(),_.TgZ(11,"mat-menu",null,23),_.TgZ(13,"button",24),_.NdJ("click",function(){_.CHM(t);const e=_.MAs(5);return _.oxw().renameList(e)}),_._UZ(14,"mat-icon",22),_._uU(15," Rename List "),_.qZA(),_.TgZ(16,"button",24),_.NdJ("click",function(){const e=_.CHM(t).$implicit;return _.oxw().deleteList(e.id)}),_._UZ(17,"mat-icon",22),_._uU(18," Delete List "),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",25),_.TgZ(20,"div",26),_.NdJ("cdkDropListDropped",function(e){return _.CHM(t),_.oxw().cardDropped(e)}),_.YNc(21,dt,7,7,"ng-container",11),_.qZA(),_.TgZ(22,"scrumboard-board-add-card",12),_.NdJ("saved",function(e){const i=_.CHM(t).$implicit;return _.oxw().addCard(i,e)}),_.qZA(),_.qZA(),_.qZA(),_.BQk()}if(2&t){const t=e.$implicit,i=_.MAs(12),r=_.oxw();_.xp6(1),_.Q6J("cdkDragLockAxis","x"),_.xp6(3),_.Q6J("spellcheck","false")("value",t.title),_.xp6(3),_.hij(" ",t.cards.length," "),_.xp6(2),_.Q6J("matMenuTriggerFor",i),_.xp6(1),_.Q6J("svgIcon","heroicons_solid:dots-vertical"),_.xp6(4),_.Q6J("svgIcon","heroicons_solid:pencil-alt"),_.xp6(3),_.Q6J("svgIcon","heroicons_solid:trash"),_.xp6(3),_.Q6J("id",t.id)("cdkDropListData",t.cards),_.xp6(1),_.Q6J("ngForOf",t.cards)("ngForTrackBy",r.trackByFn),_.xp6(1),_.Q6J("buttonTitle",t.cards.length?"Add another card":"Add a card")}}const pt=function(){return[".."]};let mt=(()=>{class t{constructor(t,e,i){this._changeDetectorRef=t,this._formBuilder=e,this._scrumboardService=i,this._positionStep=65536,this._maxListCount=200,this._maxPosition=500*this._positionStep,this._unsubscribeAll=new x.xQ}ngOnInit(){this.listTitleForm=this._formBuilder.group({title:[""]}),this._scrumboardService.board$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(t=>{this.board=Object.assign({},t),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}renameList(t){setTimeout(()=>{t.focus()})}addList(t){if(this.board.lists.length>=this._maxListCount)return;const e=new C({boardId:this.board.id,position:this.board.lists.length?this.board.lists[this.board.lists.length-1].position+this._positionStep:this._positionStep,title:t});this._scrumboardService.createList(e).subscribe()}updateListTitle(t,e){const i=t.target,r=i.value;r&&""!==r.trim()?(e.title=i.value=r.trim(),this._scrumboardService.updateList(e).subscribe()):i.value=e.title}deleteList(t){this._scrumboardService.deleteList(t).subscribe()}addCard(t,e){const i=new D({boardId:this.board.id,listId:t.id,position:t.cards.length?t.cards[t.cards.length-1].position+this._positionStep:this._positionStep,title:e});this._scrumboardService.createCard(i).subscribe()}listDropped(t){(0,s.bA)(t.container.data,t.previousIndex,t.currentIndex);const e=this._calculatePositions(t);this._scrumboardService.updateLists(e).subscribe()}cardDropped(t){t.previousContainer===t.container?(0,s.bA)(t.container.data,t.previousIndex,t.currentIndex):((0,s.EA)(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex),t.container.data[t.currentIndex].listId=t.container.id);const e=this._calculatePositions(t);this._scrumboardService.updateCards(e).subscribe()}isOverdue(t){return g(t,g.ISO_8601).isBefore(g(),"days")}trackByFn(t,e){return e.id||t}_calculatePositions(t){let e=t.container.data;const i=e[t.currentIndex],r=e[t.currentIndex-1]||null,s=e[t.currentIndex+1]||null;return i.position=r?s?(r.position+s.position)/2:r.position+this._positionStep:s?s.position/2:this._positionStep,!Number.isInteger(i.position)||i.position>=this._maxPosition?(e=e.map((t,e)=>(t.position=(e+1)*this._positionStep,t)),e):[i]}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(_.sBO),_.Y36(E.qu),_.Y36(U))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-board"]],decls:19,vars:10,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-stroked-button","",3,"routerLink"],[1,"icon-size-5","mr-2",3,"svgIcon"],["mat-stroked-button","",1,"ml-3"],["cdkScrollable","",1,"flex-auto","p-6","sm:p-8","sm:pt-4","overflow-y-auto"],["cdkDropList","",1,"flex",3,"cdkDropListData","cdkDropListOrientation","cdkDropListDropped"],["cdkDropListGroup","",1,"flex","items-start"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"buttonTitle","saved"],[1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none"],["cdkDrag","",1,"flex-0","w-72","p-2","rounded-2xl","bg-default",3,"cdkDragLockAxis"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","items-center","w-full","py-2","px-3","rounded-md","cursor-text","border","border-transparent","focus-within:bg-white","focus-within:shadow-sm","focus-within:border-primary","dark:focus-within:bg-gray-900"],[1,"w-full","font-medium","leading-5","bg-transparent",3,"spellcheck","value","focusout","keydown.enter"],["listTitleInput",""],[1,"flex","items-center","justify-center","min-w-6","ml-4","text-sm","font-semibold","leading-6","rounded-full","bg-gray-300","text-secondary","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"w-8","h-8","min-h-8",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["listMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:bg-transparent","dark:border"],["cdkDropList","",1,"p-3","pb-0",3,"id","cdkDropListData","cdkDropListDropped"],["cdkDrag","",1,"flex","flex-col","items-start","mb-3","p-5","space-y-3","shadow","rounded-lg","overflow-hidden","bg-card",3,"routerLink"],[4,"ngIf"],[1,"text-lg","font-medium","leading-5"],[1,"-mx-5","-mt-5","mb-2"],[1,"w-full","object-cover",3,"src"],[1,"flex","flex-wrap","-mx-1","-mb-2"],[1,"mx-1","mb-2","py-0.5","px-3","rounded-full","text-sm","font-medium","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"flex","items-center","rounded","text-sm","font-medium","leading-5","text-secondary",3,"ngClass"],[1,"icon-size-4","text-current",3,"svgIcon"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_.TgZ(3,"h2",3),_._uU(4),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.TgZ(6,"a",5),_._UZ(7,"mat-icon",6),_._uU(8," Boards "),_.qZA(),_.TgZ(9,"button",7),_._UZ(10,"mat-icon",6),_._uU(11," Settings "),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",8),_.TgZ(13,"div",9),_.NdJ("cdkDropListDropped",function(t){return e.listDropped(t)}),_.TgZ(14,"div",10),_.YNc(15,ut,23,13,"ng-container",11),_.TgZ(16,"scrumboard-board-add-list",12),_.NdJ("saved",function(t){return e.addList(t)}),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(17,"div",13),_._UZ(18,"router-outlet"),_.qZA()),2&t&&(_.xp6(4),_.hij(" ",e.board.title," "),_.xp6(2),_.Q6J("routerLink",_.DdM(9,pt)),_.xp6(1),_.Q6J("svgIcon","heroicons_solid:view-boards"),_.xp6(3),_.Q6J("svgIcon","heroicons_solid:cog"),_.xp6(3),_.Q6J("cdkDropListData",e.board.lists)("cdkDropListOrientation","horizontal"),_.xp6(2),_.Q6J("ngForOf",e.board.lists)("ngForTrackBy",e.trackByFn),_.xp6(1),_.Q6J("buttonTitle",e.board.lists.length?"Add another list":"Add a list"))},directives:[o.zs,r.yS,u.Hw,o.lW,F.PQ,s.Wj,s.Fd,B.sg,P,r.lC,s.Zt,s.Bh,m.p6,m.VK,m.OP,rt,B.O5,B.mk],pipes:[B.uU],styles:[".cdk-drag-preview{--tw-shadow:0 25px 50px -12px #00000040;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.cdk-drag-placeholder{opacity:0}.cdk-drag-animating,.cdk-drop-list-dragging div:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],encapsulation:2,changeDetection:0}),t})();var bt=i(54395),ht=i(56298);const gt=["labelInput"];function ft(t,e){if(1&t&&(_.ynx(0),_._uU(1),_.ALo(2,"date"),_.BQk()),2&t){const t=_.oxw();_.xp6(1),_.Oqu(_.xi3(2,1,t.card.dueDate,"longDate"))}}function xt(t,e){1&t&&(_.ynx(0),_._uU(1,"Not set"),_.BQk())}function vt(t,e){if(1&t){const t=_.EpF();_.ynx(0),_.TgZ(1,"mat-checkbox",26),_.NdJ("change",function(e){const i=_.CHM(t).$implicit;return _.oxw().toggleProductTag(i,e)}),_._uU(2),_.qZA(),_.BQk()}if(2&t){const t=e.$implicit,i=_.oxw();_.xp6(1),_.Q6J("color","primary")("checked",i.hasLabel(t)),_.xp6(1),_.hij(" ",t.title," ")}}const _t=function(t,e,i){return{"text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700":t,"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":e,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":i}};let Zt=(()=>{class t{constructor(t,e,i,r){this.matDialogRef=t,this._changeDetectorRef=e,this._formBuilder=i,this._scrumboardService=r,this._unsubscribeAll=new x.xQ}ngOnInit(){this._scrumboardService.board$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(t=>{this.board=t,this.labels=this.filteredLabels=t.labels}),this._scrumboardService.card$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(t=>{this.card=t}),this.cardForm=this._formBuilder.group({id:[""],title:["",E.kI.required],description:[""],labels:[[]],dueDate:[null]}),this.cardForm.setValue({id:this.card.id,title:this.card.title,description:this.card.description,labels:this.card.labels,dueDate:this.card.dueDate}),this.cardForm.valueChanges.pipe((0,A.b)(t=>{this.card=(0,ht.Z)(this.card,t)}),(0,bt.b)(300),(0,v.R)(this._unsubscribeAll)).subscribe(t=>{this._scrumboardService.updateCard(t.id,t).subscribe(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}hasLabel(t){return!!this.card.labels.find(e=>e.id===t.id)}filterLabels(t){const e=t.target.value.toLowerCase();this.filteredLabels=this.labels.filter(t=>t.title.toLowerCase().includes(e))}filterLabelsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredLabels.length)return;const e=this.filteredLabels[0];this.card.labels.find(t=>t.id===e.id)?this.removeLabelFromCard(e):this.addLabelToCard(e)}toggleProductTag(t,e){e.checked?this.addLabelToCard(t):this.removeLabelFromCard(t)}addLabelToCard(t){this.card.labels.unshift(t),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}removeLabelFromCard(t){this.card.labels.splice(this.card.labels.findIndex(e=>e.id===t.id),1),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}isOverdue(t){return g(t,g.ISO_8601).isBefore(g(),"days")}trackByFn(t,e){return e.id||t}_readAsDataURL(t){return new Promise((e,i)=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=t=>{i(t)},r.readAsDataURL(t)})}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(a.so),_.Y36(_.sBO),_.Y36(E.qu),_.Y36(U))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-card-details"]],viewQuery:function(t,e){if(1&t&&_.Gf(gt,5),2&t){let t;_.iGM(t=_.CRH())&&(e.labelInput=t.first)}},decls:44,vars:24,consts:[[1,"flex","flex-col","flex-auto","md:w-160","md:min-w-160","max-h-160","-m-6","overflow-y-auto"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-0","items-start","w-full","p-6","sm:p-8","space-y-6","overflow-y-auto",3,"formGroup"],[1,"fuse-mat-textarea","fuse-mat-no-subscript","w-full"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","matAutosizeMinRows"],[1,"font-medium"],[1,"relative","flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","click"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[4,"ngIf"],[1,"fuse-mat-no-subscript","fuse-mat-dense","invisible","absolute","inset-0","-mt-2.5","opacity-0","pointer-events-none"],["matInput","",3,"formControlName","matDatepicker"],["dueDatePicker",""],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",3,"color"],[1,"w-full"],[1,"mt-1","rounded-md","border","border-gray-300","shadow-sm","overflow-hidden"],[1,"flex","items-center","my-2","mx-3"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Enter label name",1,"min-w-0","ml-2","py-1","border-0",3,"maxLength","input","keydown"],[1,"max-h-40","leading-none","overflow-y-auto","border-t"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","h-10","min-h-10","px-4",3,"color","checked","change"]],template:function(t,e){if(1&t){const t=_.EpF();_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_._uU(3,"Card"),_.qZA(),_.TgZ(4,"button",3),_.NdJ("click",function(){return e.matDialogRef.close()}),_._UZ(5,"mat-icon",4),_.qZA(),_.qZA(),_.TgZ(6,"form",5),_.TgZ(7,"mat-form-field",6),_.TgZ(8,"mat-label"),_._uU(9,"Title"),_.qZA(),_.TgZ(10,"textarea",7),_._uU(11,"            "),_.qZA(),_.qZA(),_.TgZ(12,"mat-form-field",6),_.TgZ(13,"mat-label"),_._uU(14,"Description"),_.qZA(),_.TgZ(15,"textarea",7),_._uU(16,"            "),_.qZA(),_.qZA(),_.TgZ(17,"div"),_.TgZ(18,"div",8),_._uU(19,"Due date"),_.qZA(),_.TgZ(20,"div",9),_.NdJ("click",function(){return _.CHM(t),_.MAs(28).open()}),_._UZ(21,"mat-icon",10),_.TgZ(22,"span",11),_.YNc(23,ft,3,4,"ng-container",12),_.YNc(24,xt,2,0,"ng-container",12),_.qZA(),_.TgZ(25,"mat-form-field",13),_._UZ(26,"input",14),_.TgZ(27,"mat-datepicker",null,15),_.TgZ(29,"mat-datepicker-actions"),_.TgZ(30,"button",16),_.NdJ("click",function(){return e.cardForm.get("dueDate").setValue(null)}),_._uU(31," Clear "),_.qZA(),_.TgZ(32,"button",17),_._uU(33," Select "),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(34,"div",18),_.TgZ(35,"div",8),_._uU(36,"Labels"),_.qZA(),_.TgZ(37,"div",19),_.TgZ(38,"div",20),_.TgZ(39,"div",21),_._UZ(40,"mat-icon",22),_.TgZ(41,"input",23),_.NdJ("input",function(t){return e.filterLabels(t)})("keydown",function(t){return e.filterLabelsInputKeyDown(t)}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(42,"div",24),_.YNc(43,vt,3,3,"ng-container",25),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&t){const t=_.MAs(28);_.xp6(4),_.Q6J("tabIndex",-1),_.xp6(1),_.Q6J("svgIcon","heroicons_outline:x"),_.xp6(1),_.Q6J("formGroup",e.cardForm),_.xp6(4),_.Q6J("formControlName","title")("rows",1)("matAutosizeMinRows",1),_.xp6(5),_.Q6J("formControlName","description")("rows",1)("matAutosizeMinRows",1),_.xp6(5),_.Q6J("ngClass",_.kEZ(20,_t,!e.card.dueDate,e.card.dueDate&&!e.isOverdue(e.card.dueDate),e.card.dueDate&&e.isOverdue(e.card.dueDate))),_.xp6(1),_.Q6J("svgIcon","heroicons_solid:calendar"),_.xp6(2),_.Q6J("ngIf",e.card.dueDate),_.xp6(1),_.Q6J("ngIf",!e.card.dueDate),_.xp6(2),_.Q6J("formControlName","dueDate")("matDatepicker",t),_.xp6(6),_.Q6J("color","primary"),_.xp6(8),_.Q6J("svgIcon","heroicons_solid:search"),_.xp6(1),_.Q6J("maxLength",50),_.xp6(2),_.Q6J("ngForOf",e.filteredLabels)("ngForTrackBy",e.trackByFn)}},directives:[o.lW,u.Hw,E._Y,E.JL,E.sg,d.KE,d.hX,p.Nt,p.D7,E.Fj,E.JJ,E.u,B.mk,B.O5,l.hl,l.Mq,l.M5,l.dp,l.DK,B.sg,n.oG],pipes:[B.uU],encapsulation:2,changeDetection:0}),t})();const kt=[{path:"",component:M,resolve:{boards:$}},{path:":boardId",component:mt,resolve:{board:z},children:[{path:"card/:cardId",component:(()=>{class t{constructor(t,e,i){this._activatedRoute=t,this._matDialog=e,this._router=i}ngOnInit(){this._matDialog.open(Zt,{autoFocus:!1}).afterClosed().subscribe(()=>{this._router.navigate(["./../.."],{relativeTo:this._activatedRoute})})}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(r.gz),_.Y36(a.uw),_.Y36(r.F0))},t.\u0275cmp=_.Xpm({type:t,selectors:[["scrumboard-card"]],decls:1,vars:0,template:function(t,e){1&t&&_._uU(0,"SCRUMBOARD -> BOARDS -> LIST -> CARD\n")},encapsulation:2,changeDetection:0}),t})(),resolve:{card:j}}]}];let wt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({providers:[{provide:c.sG,useValue:{parse:{dateInput:g.ISO_8601},display:{dateInput:"ll",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[[r.Bz.forChild(kt),s._t,o.ot,n.p9,l.FA,a.Is,d.lN,u.Ps,p.c,m.Tx,b.Yd,h.Cv,f.m]]}),t})()}}]);