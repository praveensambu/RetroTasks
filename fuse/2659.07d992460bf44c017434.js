(self.webpackChunk_fuse_demo=self.webpackChunk_fuse_demo||[]).push([[2659],{32659:(t,e,s)=>{"use strict";s.r(e),s.d(e,{TasksModule:()=>zt});var i=s(63423),n=s(83461),a=s(21554),r=s(51095),o=s(7539),c=s(72458),l=s(43220),g=s(1769),u=s(98295),p=s(76627),d=s(83166),h=s(33935),k=s(36063),f=s(12178),m=s(82613),x=s(67441),v=s(23017),_=s(11436),Z=s(16738),T=s(7853),b=s(44466),y=s(37716);let A=(()=>{class t{canDeactivate(t,e,s,i){let n=i.root;for(;n.firstChild;)n=n.firstChild;return!i.url.includes("/tasks")||!!n.paramMap.get("id")||t.closeDrawer().then(()=>!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var w=s(40205),q=s(5304),I=s(26215),C=s(25917),Q=s(93342),J=s(15257),U=s(43190),F=s(88002),D=s(45435),N=s(91841);let Y=(()=>{class t{constructor(t){this._httpClient=t,this._tags=new I.X(null),this._task=new I.X(null),this._tasks=new I.X(null)}get tags$(){return this._tags.asObservable()}get task$(){return this._task.asObservable()}get tasks$(){return this._tasks.asObservable()}getTags(){return this._httpClient.get("api/apps/tasks/tags").pipe((0,Q.b)(t=>{this._tags.next(t)}))}createTag(t){return this.tags$.pipe((0,J.q)(1),(0,U.w)(e=>this._httpClient.post("api/apps/tasks/tag",{tag:t}).pipe((0,F.U)(t=>(this._tags.next([...e,t]),t)))))}updateTag(t,e){return this.tags$.pipe((0,J.q)(1),(0,U.w)(s=>this._httpClient.patch("api/apps/tasks/tag",{id:t,tag:e}).pipe((0,F.U)(e=>{const i=s.findIndex(e=>e.id===t);return s[i]=e,this._tags.next(s),e}))))}deleteTag(t){return this.tags$.pipe((0,J.q)(1),(0,U.w)(e=>this._httpClient.delete("api/apps/tasks/tag",{params:{id:t}}).pipe((0,F.U)(s=>{const i=e.findIndex(e=>e.id===t);return e.splice(i,1),this._tags.next(e),s}),(0,D.h)(t=>t),(0,U.w)(e=>this.tasks$.pipe((0,J.q)(1),(0,F.U)(s=>(s.forEach(e=>{const s=e.tags.findIndex(e=>e===t);s>-1&&e.tags.splice(s,1)}),e)))))))}getTasks(){return this._httpClient.get("api/apps/tasks/all").pipe((0,Q.b)(t=>{this._tasks.next(t)}))}updateTasksOrders(t){return this._httpClient.patch("api/apps/tasks/order",{tasks:t})}searchTasks(t){return this._httpClient.get("api/apps/tasks/search",{params:{query:t}})}getTaskById(t){return this._tasks.pipe((0,J.q)(1),(0,F.U)(e=>{const s=e.find(e=>e.id===t)||null;return this._task.next(s),s}),(0,U.w)(e=>e?(0,C.of)(e):(0,w._)("Could not found task with id of "+t+"!")))}createTask(t){return this.tasks$.pipe((0,J.q)(1),(0,U.w)(e=>this._httpClient.post("api/apps/tasks/task",{type:t}).pipe((0,F.U)(t=>(this._tasks.next([t,...e]),t)))))}updateTask(t,e){return this.tasks$.pipe((0,J.q)(1),(0,U.w)(s=>this._httpClient.patch("api/apps/tasks/task",{id:t,task:e}).pipe((0,F.U)(e=>{const i=s.findIndex(e=>e.id===t);return s[i]=e,this._tasks.next(s),e}),(0,U.w)(e=>this.task$.pipe((0,J.q)(1),(0,D.h)(e=>e&&e.id===t),(0,Q.b)(()=>(this._task.next(e),e)))))))}deleteTask(t){return this.tasks$.pipe((0,J.q)(1),(0,U.w)(e=>this._httpClient.delete("api/apps/tasks/task",{params:{id:t}}).pipe((0,F.U)(s=>{const i=e.findIndex(e=>e.id===t);return e.splice(i,1),this._tasks.next(e),s}))))}}return t.\u0275fac=function(e){return new(e||t)(y.LFG(N.eN))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),M=(()=>{class t{constructor(t){this._tasksService=t}resolve(t,e){return this._tasksService.getTags()}}return t.\u0275fac=function(e){return new(e||t)(y.LFG(Y))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),R=(()=>{class t{constructor(t){this._tasksService=t}resolve(t,e){return this._tasksService.getTasks()}}return t.\u0275fac=function(e){return new(e||t)(y.LFG(Y))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),B=(()=>{class t{constructor(t,e){this._router=t,this._tasksService=e}resolve(t,e){return this._tasksService.getTaskById(t.paramMap.get("id")).pipe((0,q.K)(t=>{console.error(t);const s=e.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(s),(0,w._)(t)}))}}return t.\u0275fac=function(e){return new(e||t)(y.LFG(i.F0),y.LFG(Y))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),O=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=y.Xpm({type:t,selectors:[["tasks"]],decls:1,vars:0,template:function(t,e){1&t&&y._UZ(0,"router-outlet")},directives:[i.lC],encapsulation:2,changeDetection:0}),t})();var L=s(38583),S=s(79765),E=s(22759),P=s(46782),$=s(25578),z=s(63575);const H=["matDrawer"];function j(t,e){1&t&&(y.TgZ(0,"span"),y._uU(1,"All tasks completed!"),y.qZA())}function G(t,e){if(1&t&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&t){const t=y.oxw();y.xp6(1),y.hij("",t.tasksCount.incomplete," remaining tasks")}}function V(t,e){1&t&&y._UZ(0,"div",28)}function K(t,e){1&t&&(y.ynx(0),y._UZ(1,"div",29),y.BQk())}function X(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",31),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_outline:check-circle"))}function W(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",32),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_outline:check-circle"))}function tt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"button",30),y.NdJ("click",function(){y.CHM(t);const e=y.oxw().$implicit;return y.oxw(2).toggleCompleted(e)}),y.YNc(1,X,2,1,"ng-container",9),y.YNc(2,W,2,1,"ng-container",9),y.qZA()}if(2&t){const t=y.oxw().$implicit;y.xp6(1),y.Q6J("ngIf",t.completed),y.xp6(1),y.Q6J("ngIf",!t.completed)}}function et(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"span"),y._uU(2),y.qZA(),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(2),y.Oqu(t.title)}}function st(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"span",33),y._uU(2),y.ALo(3,"titlecase"),y.qZA(),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(2),y.hij("",y.lcZ(3,1,t.type)," title")}}function it(t,e){1&t&&y._UZ(0,"mat-icon",37),2&t&&y.Q6J("svgIcon","heroicons_solid:arrow-narrow-down")("title","Low")}function nt(t,e){1&t&&y._UZ(0,"mat-icon",38),2&t&&y.Q6J("svgIcon","heroicons_solid:arrow-narrow-up")("title","High")}function at(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"div",34),y.YNc(2,it,1,2,"mat-icon",35),y.YNc(3,nt,1,2,"mat-icon",36),y.qZA(),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(2),y.Q6J("ngIf",0===t.priority),y.xp6(1),y.Q6J("ngIf",2===t.priority)}}function rt(t,e){if(1&t&&(y.TgZ(0,"div",39),y._uU(1),y.ALo(2,"date"),y.qZA()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.hij(" ",y.xi3(2,1,t.dueDate,"LLL dd")," ")}}const ot=function(t,e,s){return{"h-12 text-lg font-semibold bg-gray-50 dark:bg-transparent":t,"h-16":e,"text-hint":s}},ct=function(t){return[t]};function lt(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"div",19),y.YNc(2,V,1,0,"div",20),y.TgZ(3,"div",21),y.YNc(4,K,2,0,"ng-container",9),y.TgZ(5,"div",22),y._UZ(6,"mat-icon",23),y.qZA(),y.YNc(7,tt,3,2,"button",24),y.TgZ(8,"a",25),y.TgZ(9,"div",26),y.YNc(10,et,3,1,"ng-container",9),y.YNc(11,st,4,3,"ng-container",9),y.qZA(),y.YNc(12,at,4,2,"ng-container",9),y.YNc(13,rt,3,4,"div",27),y.qZA(),y.qZA(),y.qZA(),y.BQk()),2&t){const t=e.$implicit,s=e.first,i=y.oxw(2);y.xp6(1),y.ekj("border-t",s),y.Q6J("id","task-"+t.id)("ngClass",y.kEZ(13,ot,"section"===t.type,"task"===t.type,t.completed))("cdkDragLockAxis","y"),y.xp6(3),y.Q6J("ngIf",i.selectedTask&&i.selectedTask.id===t.id),y.xp6(2),y.Q6J("svgIcon","heroicons_solid:menu"),y.xp6(1),y.Q6J("ngIf","task"===t.type),y.xp6(1),y.Q6J("routerLink",y.VKq(17,ct,t.id)),y.xp6(2),y.Q6J("ngIf",t.title),y.xp6(1),y.Q6J("ngIf",!t.title),y.xp6(1),y.Q6J("ngIf","task"===t.type),y.xp6(1),y.Q6J("ngIf","task"===t.type)}}function gt(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.TgZ(1,"div",17),y.NdJ("cdkDropListDropped",function(e){return y.CHM(t),y.oxw().dropped(e)}),y.YNc(2,lt,14,19,"ng-container",18),y.qZA(),y.BQk()}if(2&t){const t=y.oxw();y.xp6(1),y.Q6J("cdkDropListData",t.tasks),y.xp6(1),y.Q6J("ngForOf",t.tasks)("ngForTrackBy",t.trackByFn)}}function ut(t,e){1&t&&(y.TgZ(0,"div",40),y._UZ(1,"mat-icon",41),y.TgZ(2,"div",42),y._uU(3,"Add a task to start planning!"),y.qZA(),y.qZA()),2&t&&(y.xp6(1),y.Q6J("svgIcon","iconsmind:bulleted_list"))}let pt=(()=>{class t{constructor(t,e,s,i,n,a,r){this._activatedRoute=t,this._changeDetectorRef=e,this._document=s,this._router=i,this._tasksService=n,this._fuseMediaWatcherService=a,this._fuseNavigationService=r,this.tasksCount={completed:0,incomplete:0,total:0},this._unsubscribeAll=new S.xQ}ngOnInit(){this._tasksService.tags$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=t,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.tasks=t,this.tasksCount.total=this.tasks.filter(t=>"task"===t.type).length,this.tasksCount.completed=this.tasks.filter(t=>"task"===t.type&&t.completed).length,this.tasksCount.incomplete=this.tasksCount.total-this.tasksCount.completed,this._changeDetectorRef.markForCheck(),setTimeout(()=>{const t=this._fuseNavigationService.getComponent("mainNavigation");t&&(this._fuseNavigationService.getItem("apps.tasks",t.navigation).subtitle=this.tasksCount.incomplete+" remaining tasks",t.refresh())})}),this._tasksService.task$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedTask=t,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.drawerMode=t.matches?"side":"over",this._changeDetectorRef.markForCheck()}),(0,E.R)(this._document,"keydown").pipe((0,P.R)(this._unsubscribeAll),(0,D.h)(t=>(!0===t.ctrlKey||t.metaKey)&&("/"===t.key||"."===t.key))).subscribe(t=>{"/"===t.key&&this.createTask("task"),"."===t.key&&this.createTask("section")})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createTask(t){this._tasksService.createTask(t).subscribe(t=>{this._router.navigate(["./",t.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}toggleCompleted(t){t.completed=!t.completed,this._tasksService.updateTask(t.id,t).subscribe(),this._changeDetectorRef.markForCheck()}dropped(t){(0,n.bA)(t.container.data,t.previousIndex,t.currentIndex),this._tasksService.updateTasksOrders(t.container.data).subscribe(),this._changeDetectorRef.markForCheck()}trackByFn(t,e){return e.id||t}}return t.\u0275fac=function(e){return new(e||t)(y.Y36(i.gz),y.Y36(y.sBO),y.Y36(L.K0),y.Y36(i.F0),y.Y36(Y),y.Y36($.T),y.Y36(z.Jf))},t.\u0275cmp=y.Xpm({type:t,selectors:[["tasks-list"]],viewQuery:function(t,e){if(1&t&&y.Gf(H,7),2&t){let t;y.iGM(t=y.CRH())&&(e.matDrawer=t.first)}},decls:26,vars:14,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","sm:w-128","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","py-8","px-6","md:px-8"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"ml-0.5","font-medium","text-secondary"],[4,"ngIf"],[1,"mt-4","sm:mt-0"],["mat-flat-button","",3,"color","matTooltip","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-flat-button","",1,"ml-3",3,"color","matTooltip","click"],[4,"ngIf","ngIfElse"],["noTasks",""],["cdkDropList","",1,"divide-y",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"group","w-full","select-none","hover:bg-gray-100","dark:hover:bg-hover",3,"id","ngClass","cdkDragLockAxis"],["class","flex flex-0 w-0 h-0",4,"cdkDragPreview"],[1,"relative","flex","items-center","h-full","pl-10"],["cdkDragHandle","",1,"md:hidden","absolute","flex","items-center","justify-center","inset-y-0","left-0","w-8","cursor-move","md:group-hover:flex"],[1,"icon-size-5","text-hint",3,"svgIcon"],["class","mr-2 -ml-2.5 leading-none","mat-icon-button","",3,"click",4,"ngIf"],[1,"flex","flex-auto","items-center","min-w-0","h-full","pr-7",3,"routerLink"],[1,"flex-auto","mr-2","truncate"],["class","text-sm whitespace-nowrap text-secondary",4,"ngIf"],[1,"flex","flex-0","w-0","h-0"],[1,"z-10","absolute","-top-px","right-0","-bottom-px","flex","flex-0","w-1","bg-primary"],["mat-icon-button","",1,"mr-2","-ml-2.5","leading-none",3,"click"],[1,"text-primary",3,"svgIcon"],[1,"text-hint",3,"svgIcon"],[1,"select-none","text-hint"],[1,"w-4","h-4","mr-3"],["class","icon-size-4 text-green-600 dark:text-green-400",3,"svgIcon","title",4,"ngIf"],["class","icon-size-4 text-red-600 dark:text-red-400",3,"svgIcon","title",4,"ngIf"],[1,"icon-size-4","text-green-600","dark:text-green-400",3,"svgIcon","title"],[1,"icon-size-4","text-red-600","dark:text-red-400",3,"svgIcon","title"],[1,"text-sm","whitespace-nowrap","text-secondary"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(t,e){if(1&t&&(y.TgZ(0,"div",0),y.TgZ(1,"mat-drawer-container",1),y.NdJ("backdropClick",function(){return e.onBackdropClicked()}),y.TgZ(2,"mat-drawer",2,3),y._UZ(4,"router-outlet"),y.qZA(),y.TgZ(5,"mat-drawer-content",4),y.TgZ(6,"div",5),y.TgZ(7,"div",6),y.TgZ(8,"div"),y.TgZ(9,"div",7),y._uU(10,"Tasks"),y.qZA(),y.TgZ(11,"div",8),y.YNc(12,j,2,0,"span",9),y.YNc(13,G,2,1,"span",9),y.qZA(),y.qZA(),y.TgZ(14,"div",10),y.TgZ(15,"button",11),y.NdJ("click",function(){return e.createTask("section")}),y._UZ(16,"mat-icon",12),y.TgZ(17,"span",13),y._uU(18,"Add Section"),y.qZA(),y.qZA(),y.TgZ(19,"button",14),y.NdJ("click",function(){return e.createTask("task")}),y._UZ(20,"mat-icon",12),y.TgZ(21,"span",13),y._uU(22,"Add Task"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.YNc(23,gt,3,3,"ng-container",15),y.YNc(24,ut,4,1,"ng-template",null,16,y.W1O),y.qZA(),y.qZA(),y.qZA(),y.qZA()),2&t){const t=y.MAs(25);y.xp6(2),y.Q6J("mode",e.drawerMode)("opened",!1)("position","end")("disableClose",!0),y.xp6(10),y.Q6J("ngIf",0===e.tasksCount.incomplete),y.xp6(1),y.Q6J("ngIf",0!==e.tasksCount.incomplete),y.xp6(2),y.Q6J("color","accent")("matTooltip","Shortcut: Ctrl + ."),y.xp6(1),y.Q6J("svgIcon","heroicons_outline:plus"),y.xp6(3),y.Q6J("color","primary")("matTooltip","Shortcut: Ctrl + /"),y.xp6(1),y.Q6J("svgIcon","heroicons_outline:plus"),y.xp6(3),y.Q6J("ngIf",e.tasks&&e.tasks.length>0)("ngIfElse",t)}},directives:[v.kh,v.jA,i.lC,v.LW,L.O5,r.lW,_.gM,p.Hw,n.Wj,L.sg,n.Zt,L.mk,n.pV,n.Bh,i.yS],pipes:[L.rS,L.uU],encapsulation:2,changeDetection:0}),t})();var dt=s(87636),ht=s(54395),kt=s(56298),ft=s(3679),mt=s(58203),xt=s(3005);const vt=["tagsPanelOrigin"],_t=["tagsPanel"],Zt=["titleField"];function Tt(t,e){1&t&&(y.ynx(0),y.TgZ(1,"div",39),y._UZ(2,"mat-icon",7),y.TgZ(3,"span",40),y._uU(4,"MARK AS COMPLETE"),y.qZA(),y.qZA(),y.BQk()),2&t&&(y.xp6(2),y.Q6J("svgIcon","heroicons_outline:check-circle"))}function bt(t,e){1&t&&(y.ynx(0),y.TgZ(1,"div",39),y._UZ(2,"mat-icon",41),y.TgZ(3,"span",40),y._uU(4,"MARK AS INCOMPLETE"),y.qZA(),y.qZA(),y.BQk()),2&t&&(y.xp6(2),y.Q6J("svgIcon","heroicons_outline:check-circle"))}function yt(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"div",43),y.TgZ(2,"span",44),y._uU(3),y.qZA(),y.qZA(),y.BQk()),2&t){const t=e.$implicit;y.xp6(3),y.Oqu(t.title)}}function At(t,e){if(1&t&&(y.ynx(0),y.YNc(1,yt,4,1,"ng-container",42),y.ALo(2,"fuseFindByKey"),y.BQk()),2&t){const t=y.oxw();y.xp6(1),y.Q6J("ngForOf",y.Dn7(2,2,t.task.tags,"id",t.tags))("ngForTrackBy",t.trackByFn)}}function wt(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",45),y.TgZ(2,"span",46),y._uU(3,"Edit"),y.qZA(),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_solid:pencil-alt"))}function qt(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",45),y.TgZ(2,"span",46),y._uU(3,"Add"),y.qZA(),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_solid:plus-circle"))}function It(t,e){1&t&&y._UZ(0,"mat-icon",45),2&t&&y.Q6J("svgIcon","heroicons_solid:pencil-alt")}function Ct(t,e){1&t&&y._UZ(0,"mat-icon",45),2&t&&y.Q6J("svgIcon","heroicons_solid:check")}function Qt(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.TgZ(1,"div",56),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw(3).toggleTaskTag(e)}),y._UZ(2,"mat-checkbox",57),y.TgZ(3,"div",58),y._uU(4),y.qZA(),y.qZA(),y.BQk()}if(2&t){const t=e.$implicit,s=y.oxw(3);y.xp6(2),y.Q6J("color","primary")("checked",s.task.tags.includes(t.id)),y.xp6(2),y.Oqu(t.title)}}function Jt(t,e){if(1&t&&(y.ynx(0),y.YNc(1,Qt,5,3,"ng-container",42),y.BQk()),2&t){const t=y.oxw(2);y.xp6(1),y.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function Ut(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.TgZ(1,"div",5),y.TgZ(2,"mat-form-field",60),y.TgZ(3,"input",61),y.NdJ("input",function(e){const s=y.CHM(t).$implicit;return y.oxw(3).updateTagTitle(s,e)}),y.qZA(),y.TgZ(4,"button",62),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw(3).deleteTag(e)}),y._UZ(5,"mat-icon",63),y.qZA(),y.qZA(),y.qZA(),y.BQk()}if(2&t){const t=e.$implicit;y.xp6(3),y.Q6J("value",t.title),y.xp6(2),y.Q6J("svgIcon","heroicons_solid:trash")}}function Ft(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"div",59),y.YNc(2,Ut,6,2,"ng-container",42),y.qZA(),y.BQk()),2&t){const t=y.oxw(2);y.xp6(2),y.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function Dt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",64),y.NdJ("click",function(){y.CHM(t),y.oxw();const e=y.MAs(6);return y.oxw().createTag(e.value),e.value=""}),y._UZ(1,"mat-icon",65),y.TgZ(2,"div",66),y._uU(3,'Create "'),y.TgZ(4,"b"),y._uU(5),y.qZA(),y._uU(6,'"'),y.qZA(),y.qZA()}if(2&t){y.oxw();const t=y.MAs(6);y.xp6(1),y.Q6J("svgIcon","heroicons_solid:plus-circle"),y.xp6(4),y.Oqu(t.value)}}function Nt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",47),y.TgZ(1,"div",48),y.TgZ(2,"div",5),y._UZ(3,"mat-icon",45),y.TgZ(4,"div",49),y.TgZ(5,"input",50,51),y.NdJ("input",function(e){return y.CHM(t),y.oxw().filterTags(e)})("keydown",function(e){return y.CHM(t),y.oxw().filterTagsInputKeyDown(e)}),y.qZA(),y.qZA(),y.qZA(),y.TgZ(7,"button",52),y.NdJ("click",function(){return y.CHM(t),y.oxw().toggleTagsEditMode()}),y.YNc(8,It,1,1,"mat-icon",53),y.YNc(9,Ct,1,1,"mat-icon",53),y.qZA(),y.qZA(),y.TgZ(10,"div",54),y.YNc(11,Jt,2,2,"ng-container",4),y.YNc(12,Ft,3,2,"ng-container",4),y.YNc(13,Dt,7,2,"div",55),y.qZA(),y.qZA()}if(2&t){const t=y.MAs(6),e=y.oxw();y.xp6(3),y.Q6J("svgIcon","heroicons_solid:search"),y.xp6(2),y.Q6J("maxLength",30),y.xp6(3),y.Q6J("ngIf",!e.tagsEditMode),y.xp6(1),y.Q6J("ngIf",e.tagsEditMode),y.xp6(2),y.Q6J("ngIf",!e.tagsEditMode),y.xp6(1),y.Q6J("ngIf",e.tagsEditMode),y.xp6(1),y.Q6J("ngIf",e.shouldShowCreateTagButton(t.value))}}function Yt(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",32),y.TgZ(2,"span",67),y._uU(3,"Low"),y.qZA(),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_solid:arrow-narrow-down"))}function Mt(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",68),y.TgZ(2,"span",67),y._uU(3,"Normal"),y.qZA(),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_solid:minus"))}function Rt(t,e){1&t&&(y.ynx(0),y._UZ(1,"mat-icon",68),y.TgZ(2,"span",67),y._uU(3,"High"),y.qZA(),y.BQk()),2&t&&(y.xp6(1),y.Q6J("svgIcon","heroicons_solid:arrow-narrow-up"))}function Bt(t,e){if(1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"date"),y.BQk()),2&t){const t=y.oxw();y.xp6(1),y.Oqu(y.xi3(2,1,t.task.dueDate,"longDate"))}}function Ot(t,e){1&t&&(y.ynx(0),y._uU(1,"Not set"),y.BQk())}const Lt=function(){return["../"]},St=function(t,e,s){return{"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":t,"text-gray-800 bg-gray-200 dark:text-gray-100 dark:bg-gray-500":e,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":s}},Et=function(t){return{"bg-hover":t}},Pt=function(t,e,s){return{"text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700":t,"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":e,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":s}},$t=[{path:"",component:O,resolve:{tags:M},children:[{path:"",component:pt,resolve:{tasks:R},children:[{path:":id",component:(()=>{class t{constructor(t,e,s,i,n,a,r,o,c){this._activatedRoute=t,this._changeDetectorRef=e,this._formBuilder=s,this._renderer2=i,this._router=n,this._tasksListComponent=a,this._tasksService=r,this._overlay=o,this._viewContainerRef=c,this.tagsEditMode=!1,this._unsubscribeAll=new S.xQ}ngOnInit(){this._tasksListComponent.matDrawer.open(),this.taskForm=this._formBuilder.group({id:[""],type:[""],title:[""],notes:[""],completed:[!1],dueDate:[null],priority:[0],tags:[[]],order:[0]}),this._tasksService.tags$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=t,this.filteredTags=t,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this.tasks=t,this._changeDetectorRef.markForCheck()}),this._tasksService.task$.pipe((0,P.R)(this._unsubscribeAll)).subscribe(t=>{this._tasksListComponent.matDrawer.open(),this.task=t,this.taskForm.patchValue(t,{emitEvent:!1}),this._changeDetectorRef.markForCheck()}),this.taskForm.valueChanges.pipe((0,Q.b)(t=>{this.task=(0,kt.Z)(this.task,t)}),(0,ht.b)(300),(0,P.R)(this._unsubscribeAll)).subscribe(t=>{this._tasksService.updateTask(t.id,t).subscribe(),this._changeDetectorRef.markForCheck()}),this._router.events.pipe((0,P.R)(this._unsubscribeAll),(0,D.h)(t=>t instanceof i.m2)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngAfterViewInit(){this._tasksListComponent.matDrawer.openedChange.pipe((0,P.R)(this._unsubscribeAll),(0,D.h)(t=>t)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._tasksListComponent.matDrawer.close()}toggleCompleted(){const t=this.taskForm.get("completed");t.setValue(!t.value)}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});const t=new dt.UE(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(t),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),t&&t.isAttached&&t.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const e=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(t=>t.title.toLowerCase().includes(e))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const e=this.filteredTags[0];this.task.tags.find(t=>t===e.id)?this.deleteTagFromTask(e):this.addTagToTask(e)}createTag(t){this._tasksService.createTag({title:t}).subscribe(t=>{this.addTagToTask(t)})}updateTagTitle(t,e){t.title=e.target.value,this._tasksService.updateTag(t.id,t).pipe((0,ht.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(t){this._tasksService.deleteTag(t.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToTask(t){this.task.tags.unshift(t.id),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}deleteTagFromTask(t){this.task.tags.splice(this.task.tags.findIndex(e=>e===t.id),1),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}toggleTaskTag(t){this.task.tags.includes(t.id)?this.deleteTagFromTask(t):this.addTagToTask(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(e=>e.title.toLowerCase()===t.toLowerCase())>-1)}setTaskPriority(t){this.taskForm.get("priority").setValue(t)}isOverdue(){return Z(this.task.dueDate,Z.ISO_8601).isBefore(Z(),"days")}deleteTask(){const t=this.task.id,e=this.tasks.findIndex(e=>e.id===t),s=1===this.tasks.length&&this.tasks[0].id===t?null:this.tasks[e+(e===this.tasks.length-1?-1:1)].id;this._tasksService.deleteTask(t).subscribe(t=>{t&&this._router.navigate(s?["../",s]:["../"],{relativeTo:this._activatedRoute})}),this._changeDetectorRef.markForCheck()}trackByFn(t,e){return e.id||t}}return t.\u0275fac=function(e){return new(e||t)(y.Y36(i.gz),y.Y36(y.sBO),y.Y36(ft.qu),y.Y36(y.Qsj),y.Y36(i.F0),y.Y36(pt),y.Y36(Y),y.Y36(mt.aV),y.Y36(y.s_b))},t.\u0275cmp=y.Xpm({type:t,selectors:[["tasks-details"]],viewQuery:function(t,e){if(1&t&&(y.Gf(vt,5),y.Gf(_t,5),y.Gf(Zt,5)),2&t){let t;y.iGM(t=y.CRH())&&(e._tagsPanelOrigin=t.first),y.iGM(t=y.CRH())&&(e._tagsPanel=t.first),y.iGM(t=y.CRH())&&(e._titleField=t.first)}},decls:82,vars:50,consts:[[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","p-6","pt-10","sm:p-8","sm:pt-10","overflow-y-auto",3,"formGroup"],[1,"flex","items-center","justify-between","-mt-3","-ml-4"],["mat-button","",1,"pr-4","pl-3.5",3,"click"],[4,"ngIf"],[1,"flex","items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["moreMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"routerLink"],[1,"mt-6","mb-8"],[1,"fuse-mat-textarea","fuse-mat-no-subscript","w-full"],["matInput","","matTextareaAutosize","",3,"formControlName","spellcheck"],["titleField",""],[1,"mt-8"],[1,"font-medium","mb-1.5"],[1,"flex","flex-wrap","items-center","-m-1.5"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","cursor-pointer","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"click"],["tagsPanelOrigin",""],["tagsPanel",""],[1,"flex","flex-wrap","items-center","mt-8"],[1,"font-medium"],[1,"flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","matMenuTriggerFor"],["priorityMenu","matMenu"],["mat-menu-item","",3,"ngClass","click"],[1,"inline-flex","items-center","justify-between","w-full","min-w-30","leading-5"],[1,"mr-0","icon-size-4","text-green-600","dark:text-green-500",3,"svgIcon"],[1,"mr-0","icon-size-4","text-gray-600","dark:text-gray-500",3,"svgIcon"],[1,"mr-0","icon-size-4","text-red-600","dark:text-red-500",3,"svgIcon"],[1,"ml-6"],[1,"relative","flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","click"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-no-subscript","fuse-mat-dense","invisible","absolute","inset-0","-mt-2.5","opacity-0","pointer-events-none"],["matInput","",3,"formControlName","matDatepicker"],["dueDatePicker",""],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",1,"",3,"color"],[1,"flex","items-center","justify-center"],[1,"ml-2","font-semibold"],[1,"text-primary",3,"svgIcon"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"text-md","font-medium","whitespace-nowrap"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-1.5","text-md","font-medium","whitespace-nowrap"],[1,"w-60","rounded","border","shadow-md","bg-card"],[1,"flex","items-center","m-3","mr-2"],[1,"ml-2"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","py-1","border-0",3,"maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"ml-1",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"flex","flex-col","max-h-64","py-2","border-t","overflow-y-auto"],["class","flex items-center h-10 min-h-10 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer hover:bg-hover","matRipple","",3,"click",4,"ngIf"],["matRipple","",1,"flex","items-center","h-10","min-h-10","px-4","cursor-pointer","hover:bg-hover",3,"click"],[1,"flex","items-center","h-10","min-h-10",3,"color","checked"],[1,"ml-1"],[1,"py-2","space-y-2"],[1,"fuse-mat-dense","fuse-mat-no-subscript","w-full","mx-4"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],[1,"icon-size-5","ml-2",3,"svgIcon"],["matRipple","",1,"flex","items-center","h-10","min-h-10","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"ml-2","mr-1","text-md","font-medium"],[1,"icon-size-4","text-current",3,"svgIcon"]],template:function(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",0),y.TgZ(1,"form",1),y.TgZ(2,"div",2),y.TgZ(3,"button",3),y.NdJ("click",function(){return e.toggleCompleted()}),y.YNc(4,Tt,5,1,"ng-container",4),y.YNc(5,bt,5,1,"ng-container",4),y.qZA(),y.TgZ(6,"div",5),y.TgZ(7,"button",6),y._UZ(8,"mat-icon",7),y.qZA(),y.TgZ(9,"mat-menu",null,8),y.TgZ(11,"button",9),y.NdJ("click",function(){return e.deleteTask()}),y._UZ(12,"mat-icon",7),y.TgZ(13,"span"),y._uU(14),y.qZA(),y.qZA(),y.qZA(),y.TgZ(15,"button",10),y._UZ(16,"mat-icon",7),y.qZA(),y.qZA(),y.qZA(),y._UZ(17,"mat-divider",11),y.TgZ(18,"div"),y.TgZ(19,"mat-form-field",12),y.TgZ(20,"mat-label"),y._uU(21),y.qZA(),y._UZ(22,"textarea",13,14),y.qZA(),y.qZA(),y.TgZ(24,"div",15),y.TgZ(25,"div",16),y._uU(26,"Tags"),y.qZA(),y.TgZ(27,"div",17),y.YNc(28,At,3,6,"ng-container",4),y.TgZ(29,"div",18,19),y.NdJ("click",function(){return e.openTagsPanel()}),y.YNc(31,wt,4,1,"ng-container",4),y.YNc(32,qt,4,1,"ng-container",4),y.YNc(33,Nt,14,7,"ng-template",null,20,y.W1O),y.qZA(),y.qZA(),y.qZA(),y.TgZ(35,"div",21),y.TgZ(36,"div"),y.TgZ(37,"div",22),y._uU(38,"Priority"),y.qZA(),y.TgZ(39,"div",23),y.YNc(40,Yt,4,1,"ng-container",4),y.YNc(41,Mt,4,1,"ng-container",4),y.YNc(42,Rt,4,1,"ng-container",4),y.qZA(),y.TgZ(43,"mat-menu",null,24),y.TgZ(45,"button",25),y.NdJ("click",function(){return e.setTaskPriority(0)}),y.TgZ(46,"span",26),y.TgZ(47,"span",22),y._uU(48,"Low"),y.qZA(),y._UZ(49,"mat-icon",27),y.qZA(),y.qZA(),y.TgZ(50,"button",25),y.NdJ("click",function(){return e.setTaskPriority(1)}),y.TgZ(51,"span",26),y.TgZ(52,"span",22),y._uU(53,"Normal"),y.qZA(),y._UZ(54,"mat-icon",28),y.qZA(),y.qZA(),y.TgZ(55,"button",25),y.NdJ("click",function(){return e.setTaskPriority(2)}),y.TgZ(56,"span",26),y.TgZ(57,"span",22),y._uU(58,"High"),y.qZA(),y._UZ(59,"mat-icon",29),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(60,"div",30),y.TgZ(61,"div",22),y._uU(62,"Due date"),y.qZA(),y.TgZ(63,"div",31),y.NdJ("click",function(){return y.CHM(t),y.MAs(71).open()}),y._UZ(64,"mat-icon",32),y.TgZ(65,"span",33),y.YNc(66,Bt,3,4,"ng-container",4),y.YNc(67,Ot,2,0,"ng-container",4),y.qZA(),y.TgZ(68,"mat-form-field",34),y._UZ(69,"input",35),y.TgZ(70,"mat-datepicker",null,36),y.TgZ(72,"mat-datepicker-actions"),y.TgZ(73,"button",37),y.NdJ("click",function(){return e.taskForm.get("dueDate").setValue(null)}),y._uU(74,"Clear "),y.qZA(),y.TgZ(75,"button",38),y._uU(76,"Select "),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(77,"div",15),y.TgZ(78,"mat-form-field",12),y.TgZ(79,"mat-label"),y._uU(80,"Notes"),y.qZA(),y._UZ(81,"textarea",13),y.qZA(),y.qZA(),y.qZA(),y.qZA()}if(2&t){const t=y.MAs(10),s=y.MAs(44),i=y.MAs(71);y.xp6(1),y.Q6J("formGroup",e.taskForm),y.xp6(3),y.Q6J("ngIf",!e.taskForm.get("completed").value),y.xp6(1),y.Q6J("ngIf",e.taskForm.get("completed").value),y.xp6(2),y.Q6J("matMenuTriggerFor",t),y.xp6(1),y.Q6J("svgIcon","heroicons_outline:dots-vertical"),y.xp6(4),y.Q6J("svgIcon","heroicons_outline:trash"),y.xp6(2),y.hij("Delete ","task"===e.task.type?"task":"section",""),y.xp6(1),y.Q6J("routerLink",y.DdM(35,Lt)),y.xp6(1),y.Q6J("svgIcon","heroicons_outline:x"),y.xp6(5),y.Oqu("task"===e.task.type?"Task title":"Section title"),y.xp6(1),y.Q6J("formControlName","title")("spellcheck",!1),y.xp6(6),y.Q6J("ngIf",e.task.tags.length),y.xp6(3),y.Q6J("ngIf",e.task.tags.length),y.xp6(1),y.Q6J("ngIf",!e.task.tags.length),y.xp6(7),y.Q6J("ngClass",y.kEZ(36,St,0===e.task.priority,1===e.task.priority,2===e.task.priority))("matMenuTriggerFor",s),y.xp6(1),y.Q6J("ngIf",0===e.task.priority),y.xp6(1),y.Q6J("ngIf",1===e.task.priority),y.xp6(1),y.Q6J("ngIf",2===e.task.priority),y.xp6(3),y.Q6J("ngClass",y.VKq(40,Et,0===e.task.priority)),y.xp6(4),y.Q6J("svgIcon","heroicons_solid:arrow-narrow-down"),y.xp6(1),y.Q6J("ngClass",y.VKq(42,Et,1===e.task.priority)),y.xp6(4),y.Q6J("svgIcon","heroicons_solid:minus"),y.xp6(1),y.Q6J("ngClass",y.VKq(44,Et,2===e.task.priority)),y.xp6(4),y.Q6J("svgIcon","heroicons_solid:arrow-narrow-up"),y.xp6(4),y.Q6J("ngClass",y.kEZ(46,Pt,!e.task.dueDate,e.task.dueDate&&!e.isOverdue(),e.task.dueDate&&e.isOverdue())),y.xp6(1),y.Q6J("svgIcon","heroicons_solid:calendar"),y.xp6(2),y.Q6J("ngIf",e.task.dueDate),y.xp6(1),y.Q6J("ngIf",!e.task.dueDate),y.xp6(2),y.Q6J("formControlName","dueDate")("matDatepicker",i),y.xp6(6),y.Q6J("color","primary"),y.xp6(6),y.Q6J("formControlName","notes")("spellcheck",!1)}},directives:[ft._Y,ft.JL,ft.sg,r.lW,L.O5,h.p6,p.Hw,h.VK,h.OP,i.rH,g.d,u.KE,u.hX,d.Nt,d.D7,ft.Fj,ft.JJ,ft.u,L.mk,l.hl,l.Mq,l.M5,l.dp,l.DK,L.sg,c.wG,o.oG,u.R9],pipes:[xt.K,L.uU],encapsulation:2,changeDetection:0}),t})(),resolve:{task:B},canDeactivate:[A]}]}]}];let zt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({providers:[{provide:c.sG,useValue:{parse:{dateInput:Z.ISO_8601},display:{dateInput:"ll",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[[i.Bz.forChild($t),n._t,a.Bb,r.ot,o.p9,l.FA,g.t,u.lN,p.Ps,d.c,h.Tx,k.Yd,f.Cv,m.Fk,c.si,x.LD,v.SJ,_.AV,T.V,b.m]]}),t})()}}]);